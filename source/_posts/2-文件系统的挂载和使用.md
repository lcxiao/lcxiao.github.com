---
title: 文件系统的挂载和使用
date: 2020-05-06 06:59:43
layout:
updated:
comments:
categories:
tags:
---
## 文件系统的使用 挂载和卸载
`mount` 和 `umount`
根文件系统以为的文件系统要想能够被访问,必须通过 “关联” 至根文件系统的某个目录上，此关联即为 “挂载” ；此目录即为 “挂载点” ；
mount_point：用于作为另一个文件系统的访问入口；
1. 事先存在
2. 应该使用未被或者不会被其他进程使用到的目录；
3. 挂载点下原有的文件会被隐藏；（最好是使用原来是空的目录）；
### mount命令：
```
    mount [-fnrsvw] [-t vfstype] [-o options] device dir
        -r： readonly，只读挂载（比如光盘）；
        -w: read and write 读写挂载；
        -n： 默认情况下，设备挂载或者卸载的操作会同步更新至/etc/mtab文件中，-n用于禁止此特性；
        -t vfstype：指明要挂载的设备上的文件系统的类型，多数情况下可自动识别，mount会通过blkid来判断要挂载的设备的文件系统类型；
        -L LABEL： 挂载是以卷标的方式指明设备；
        -U UUID DIR: 通过UUID挂载设备；
        -o: 挂载选项；
            sync/async: 同步/异步操作；（异步是先写入内存，随后写入磁盘，性能好，但安全行肯定没有同步安全）
            atime/noatime: 每个文件或目录被访问时是否立即更新其访问时间戳；
            diratime/nodiratime: 每个目录被访问时是否立即更新其访问时间戳；
            remount: 重新挂载
            acl: 支持使用acl功能；
            mount -o acl DEVICE DIR
            tune2fs -o acl device
            ro： 只读
            rw： 读写
            dev/nodev： 此设备上是否允许创建设备文件；
            exec/noexec： 是否允许运行此设备上的文件；
            auto/noauto： 是否允许自动运行；
            user/nouser： 是否允许普通用户挂载此文件系统；
            suid/nosuid： 是否允许程序文件上的suid和sgid特殊权限生效；
            defaults： 使用默认选项：rw，suid，dev，exec，auto，nouser和async。
                请注意，所有默认安装选项的实际设置取决于内核和文件系统类型。
    技巧：可以实现将目录绑定至另一个目录上，作为其临时访问入口
    mount --bind 源目录 目标目录
```
mount -r /dev/cdrom mount_point
##### 光盘设备一般为：
    /dev/cdrom 
    /dev/dvd 
    /dev/sr0
##### 挂载U盘：
    事先识别U盘的设备文件：
##### 挂载本地回环设备；
    mount -o loop /PATH/TO?SOME_LOOP_FILE MOUNT_POINT
    例如ISO镜像文件
#### 查看当前已挂载的设备:
    mount
    cat /proc/mounts
    cat /etc/mtab

### 查看挂载设备被哪些进程所占用
    fuser -v MOUNT_POINT
    lsof MOUNT_POINT
### 终止所有正在访问某挂载点的进程：
    fuser -km MOUNT_POINT
### umount命令：
    umount device | dir
注意：正在被进程访问到的挂载点无法被卸载：

### 交换分区
    mkswap
    启用：swapon
        -a 所有swap文件；(定义在fstab文件中的swap设备)；
    禁用：swapoff
        swapoff DEVICE
### 设定除根文件系统以外的其他文件系统能够开机时自动挂载： /etc/fstab文件
| 要挂载的设备 | 挂载点 | 文件系统类型 | 挂载选项 | 转储频率（备份）|  自检次序 |
|  ----     |  ----     | ----       | ----  | ----      |  ---- |
| 设备文件   | swap为swap      |     | defaults  |   0从不    |  0不自检         |
| LABEL     |           |           |     acl        |    1每天   |  1，首先自检，通常根是1        |
| UUID      |           |           |      noatime        |    2隔天   |  2 次级自检       |
| 伪文件系统proc，sysfs，tmpfs |           |              |    noexec       |       |           |

mount -a： 可自动挂载定义在此文件中的所有支持的自动挂载的设备

### 两个命令：
    du：估计文件空间使用率;
        -h: 以人类可读的格式打印尺寸（例如1K 234M 2G）
        -s: 对于目录，不包括子目录的大小;
    df：报告文件系统磁盘空间使用情况;
        -l: 将列表限制为本地文件系统;
        -h: 以1024的幂为单位的打印尺寸（例如1023M）
        -i: 列出索引节点信息而不是块使用情况;
        -a: 包括伪，重复，不可访问的文件系统;

